{
  "name": "RDS Database Test Scenarios",
  "description": "Comprehensive test cases for RDS instance name masking",
  "scenarios": [
    {
      "id": "rds-001",
      "name": "Simple RDS Instance",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Check the status of production-db instance"
          }
        ]
      },
      "expected_masking": {
        "patterns": ["production-db"],
        "masked_format": "AWS_RDS_001"
      }
    },
    {
      "id": "rds-002",
      "name": "Multiple RDS Instances",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Compare performance metrics between primary-db, replica-db-1, and analytics-db-prod"
          }
        ]
      },
      "expected_masking": {
        "patterns": [
          "primary-db",
          "replica-db-1",
          "analytics-db-prod"
        ],
        "masked_format": ["AWS_RDS_001", "AWS_RDS_002", "AWS_RDS_003"]
      }
    },
    {
      "id": "rds-003",
      "name": "RDS Endpoint URLs",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Connect to mysql-prod-db.c1234567890.ap-northeast-2.rds.amazonaws.com and postgres-analytics-db.c0987654321.us-east-1.rds.amazonaws.com"
          }
        ]
      },
      "expected_masking": {
        "patterns": [
          "mysql-prod-db",
          "postgres-analytics-db"
        ],
        "preserve_endpoints": false
      }
    },
    {
      "id": "rds-004",
      "name": "RDS Describe Output",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "aws rds describe-db-instances output:\n{\n  \"DBInstances\": [\n    {\n      \"DBInstanceIdentifier\": \"production-mysql-db\",\n      \"DBInstanceClass\": \"db.r5.large\",\n      \"Engine\": \"mysql\",\n      \"DBSubnetGroup\": {\n        \"Subnets\": [\n          {\n            \"SubnetIdentifier\": \"subnet-12345678901234567\"\n          }\n        ]\n      },\n      \"VpcSecurityGroups\": [\n        {\n          \"VpcSecurityGroupId\": \"sg-abcdef12\"\n        }\n      ]\n    }\n  ]\n}"
          }
        ]
      },
      "expected_masking": {
        "complex_json": true,
        "multiple_resource_types": true
      }
    },
    {
      "id": "rds-005",
      "name": "RDS Cluster Configuration",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Aurora cluster configuration: writer endpoint aurora-cluster-db.cluster-c123456.region.rds.amazonaws.com, reader endpoint aurora-cluster-db.cluster-ro-c123456.region.rds.amazonaws.com"
          }
        ]
      },
      "validation": {
        "mask_cluster_names": true,
        "preserve_endpoint_types": true
      }
    }
  ]
}