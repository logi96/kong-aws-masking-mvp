{
  "name": "IAM and Credentials Test Scenarios",
  "description": "Test cases for IAM resources and AWS credentials masking",
  "scenarios": [
    {
      "id": "iam-001",
      "name": "IAM Role ARN",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Assume role arn:aws:iam::123456789012:role/EC2InstanceRole for EC2 instance"
          }
        ]
      },
      "expected_masking": {
        "patterns": [
          "arn:aws:iam::123456789012:role/EC2InstanceRole",
          "123456789012"
        ]
      }
    },
    {
      "id": "iam-002",
      "name": "IAM User and Policy",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "User arn:aws:iam::987654321098:user/admin-user has policy arn:aws:iam::987654321098:policy/S3ReadOnlyAccess attached"
          }
        ]
      },
      "expected_masking": {
        "patterns": [
          "arn:aws:iam::987654321098:user/admin-user",
          "arn:aws:iam::987654321098:policy/S3ReadOnlyAccess",
          "987654321098"
        ]
      }
    },
    {
      "id": "iam-003",
      "name": "AWS Access Keys",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Configure AWS CLI with access key AKIAIOSFODNN7EXAMPLE"
          }
        ]
      },
      "expected_masking": {
        "patterns": ["AKIAIOSFODNN7EXAMPLE"],
        "critical_security": true
      }
    },
    {
      "id": "iam-004",
      "name": "STS Temporary Credentials",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Temporary credentials: AccessKeyId=ASIATESTACCESSKEY123, SessionToken=FwoGZXIvYXdzEBYaDEXAMPLETOKEN123456789"
          }
        ]
      },
      "expected_masking": {
        "patterns": [
          "ASIATESTACCESSKEY123",
          "FwoGZXIvYXdzEBYaDEXAMPLETOKEN123456789"
        ]
      }
    },
    {
      "id": "iam-005",
      "name": "Cross-Account Role Trust",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Trust policy allows accounts 111111111111, 222222222222, and 333333333333 to assume role arn:aws:iam::444444444444:role/CrossAccountRole"
          }
        ]
      },
      "validation": {
        "mask_all_account_ids": true,
        "preserve_trust_relationships": true
      }
    }
  ]
}