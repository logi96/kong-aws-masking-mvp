{
  "name": "S3 Bucket Test Scenarios",
  "description": "Comprehensive test cases for S3 bucket name masking",
  "scenarios": [
    {
      "id": "s3-001",
      "name": "Simple S3 Bucket Name",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Check the contents of s3://my-company-bucket"
          }
        ]
      },
      "expected_masking": {
        "patterns": ["my-company-bucket"],
        "masked_format": "AWS_S3_BUCKET_001"
      }
    },
    {
      "id": "s3-002",
      "name": "S3 Logs Bucket",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Analyze logs from production-logs-2024 and staging-logs-backup buckets"
          }
        ]
      },
      "expected_masking": {
        "patterns": [
          "production-logs-2024",
          "staging-logs-backup"
        ],
        "masked_format": ["AWS_S3_LOGS_BUCKET_001", "AWS_S3_LOGS_BUCKET_002"]
      }
    },
    {
      "id": "s3-003",
      "name": "S3 Bucket ARN Format",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Grant access to arn:aws:s3:::data-analytics-bucket/* and arn:aws:s3:::ml-training-bucket/models/*"
          }
        ]
      },
      "expected_masking": {
        "patterns": [
          "data-analytics-bucket",
          "ml-training-bucket"
        ]
      }
    },
    {
      "id": "s3-004",
      "name": "S3 CLI List Output",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "aws s3 ls output:\n2024-01-15 10:30:00 dev-bucket-frontend\n2024-01-15 11:45:00 prod-bucket-backend\n2024-01-16 09:00:00 test-logs-archive\n2024-01-16 14:20:00 backup-database-bucket"
          }
        ]
      },
      "expected_masking": {
        "multiple_patterns": true,
        "preserve_timestamps": true
      }
    },
    {
      "id": "s3-005",
      "name": "S3 Bucket Policy",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Review this bucket policy:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": \"*\",\n      \"Action\": \"s3:GetObject\",\n      \"Resource\": [\n        \"arn:aws:s3:::public-website-bucket/*\",\n        \"arn:aws:s3:::static-assets-bucket/*\"\n      ]\n    }\n  ]\n}"
          }
        ]
      },
      "validation": {
        "preserve_json_structure": true,
        "mask_bucket_names": true
      }
    }
  ]
}