{
  "name": "EC2 Instance Test Scenarios",
  "description": "Comprehensive test cases for EC2 instance masking",
  "scenarios": [
    {
      "id": "ec2-001",
      "name": "Single EC2 Instance ID",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Analyze the security of EC2 instance i-1234567890abcdef0"
          }
        ]
      },
      "expected_masking": {
        "patterns": ["i-1234567890abcdef0"],
        "masked_format": "AWS_EC2_001"
      },
      "validation": {
        "response_should_contain": ["AWS_EC2_001"],
        "response_should_not_contain": ["i-1234567890abcdef0"]
      }
    },
    {
      "id": "ec2-002",
      "name": "Multiple EC2 Instances",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Compare performance between instances i-0a1b2c3d4e5f67890, i-fedcba0987654321f, and i-1a2b3c4d5e6f7890a"
          }
        ]
      },
      "expected_masking": {
        "patterns": [
          "i-0a1b2c3d4e5f67890",
          "i-fedcba0987654321f",
          "i-1a2b3c4d5e6f7890a"
        ],
        "masked_format": ["AWS_EC2_001", "AWS_EC2_002", "AWS_EC2_003"]
      }
    },
    {
      "id": "ec2-003",
      "name": "EC2 with AMI and Security Groups",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Instance i-abc123def4567890a is running AMI ami-0123456789abcdef0 with security group sg-12345678"
          }
        ]
      },
      "expected_masking": {
        "patterns": [
          "i-abc123def4567890a",
          "ami-0123456789abcdef0",
          "sg-12345678"
        ],
        "masked_format": ["AWS_EC2_001", "AWS_AMI_001", "AWS_SECURITY_GROUP_001"]
      }
    },
    {
      "id": "ec2-004",
      "name": "EC2 Describe Instances Output",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "aws ec2 describe-instances output:\n{\n  \"Instances\": [\n    {\n      \"InstanceId\": \"i-0123456789abcdef0\",\n      \"ImageId\": \"ami-12345678\",\n      \"SubnetId\": \"subnet-12345678901234567\",\n      \"VpcId\": \"vpc-12345678\",\n      \"SecurityGroups\": [\n        {\n          \"GroupId\": \"sg-abcdef12\"\n        }\n      ]\n    }\n  ]\n}"
          }
        ]
      },
      "expected_masking": {
        "patterns": [
          "i-0123456789abcdef0",
          "ami-12345678",
          "subnet-12345678901234567",
          "vpc-12345678",
          "sg-abcdef12"
        ]
      }
    },
    {
      "id": "ec2-005",
      "name": "EC2 Instance State Change",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Monitor state changes for instances: i-aaa111bbb222ccc33 (running), i-ddd444eee555fff66 (stopped), i-ggg777hhh888iii99 (terminated)"
          }
        ]
      },
      "validation": {
        "masking_consistency": true,
        "preserve_state_info": true
      }
    }
  ]
}